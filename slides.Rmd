---
title: "Obscure Packages"
subtitle: "PHI useR Group"
author: 'Jack Hannah <br> Transforming Publishing Programme <br>'
date: "26 March 2019 <br><br> Slides: https://github.com/jackhannah95/obscure-packages/"
output:
  ioslides_presentation:
    css: my-theme.css
---

```{r setup, include = FALSE}
# Load packages required
library(knitr)
library(dplyr)
library(tidylog)
library(magrittr)

#knitr::opts_chunk$set(echo = FALSE)



# Create data frame for table
table_contents <- data.frame(c("Text", "Text",
                               "Text", "Text",
                               "Text"),
                             c(1:5))
```


## tidylog

- [tidylog](https://github.com/elbersb/tidylog) provides wrappers around basic 
[dplyr](https://github.com/tidyverse/dplyr) functions

- These wrapper functions print a message in the console to describe the result 
of applying the corresponding dplyr function

- To use, just load tidylog after dplyr:

```{r eval = FALSE, results = "hide"}
library(dplyr)
library(tidylog)
```


## tidylog::filter()

```{r, echo = TRUE, results = "hold"}
copd <- tibble(chi_number = c(1, 2, 3, 4),
               main_condition = c("J430", "R268", "J404", "J449"))
copd
```


## tidylog::filter()

```{r, echo = TRUE, results = "hold"}
copd <- tibble(chi_number = c(1, 2, 3, 4),
            main_condition = c("J430", "R268", "J404", "J449"))

# Select cases with COPD diagnosis (J40 - J44)
p <- copd %>%
  filter(substr(main_condition, 1, 1) == "j" &
           between(as.numeric(substr(main_condition, 2, 3)), 40, 44))

# No rows selected - check code for error
```

```{r, echo = FALSE}
readr::write_csv(copd, here::here("data", "copd.csv"))
```


## here

- If you ever start an R script with setwd() or rm(list = ls()) - stop

- Instead, use [here](https://github.com/r-lib/here) and [RStudio Projects](https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects)

- Projects automatically set your working directory and here allows you to 
define filepaths relatively to it

```{r results = "hold"}
library(here)
getwd()
```


## here::here()

```{r results = "hold"}
# Load earlier dataset copd - saved in "data" sub-folder
readr::read_csv(here("data", "copd.csv"))
```


## janitor

- [janitor](https://github.com/sfirke/janitor) provides a multitude of functions 
for 'cleaning' data

- It's specifically designed with beginner and intermediate R users in mind

- While not part of the tidyverse, it's designed to work well with pipes

```{r, echo = FALSE, fig.align = 'center'}
include_graphics("images/janitor_logo.png")
```


## janitor::clean_names()

```{r, echo = TRUE, results = "hold"}
names <- tibble(VAR_ONE = "ALL CAPS",
                var.two = "dot",
                VarThree = "No space",
                `Var four` = "Space",
                `% Var` = "symbol")
names
```


## janitor::clean_names()

```{r, echo = TRUE, results = "hold"}
names <- tibble(VAR_ONE = "ALL CAPS",
                var.two = "dot",
                VarThree = "No space",
                `Var four` = "Space",
                `% Var` = "symbol")
names %>%
  janitor::clean_names()
```

